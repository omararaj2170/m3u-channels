<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Satellite IPTV</title>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  background: black;
  color: white;
  font-family: Arial, sans-serif;
  overflow: hidden;
}

/* ===== VIDEO ===== */
#video {
  width: 100vw;
  height: 100vh;
  background: black;
}

/* ===== INFO BAR ===== */
#info {
  position: absolute;
  left: 0;
  bottom: 0;
  width: 100%;
  height: 110px;
  background: linear-gradient(to top, rgba(0,0,0,.85), transparent);
  display: flex;
  align-items: center;
  padding: 20px;
  gap: 20px;
  font-size: 22px;
  opacity: 0;
  transition: opacity .3s;
}

#info.show {
  opacity: 1;
}

#ch-num {
  font-size: 36px;
  font-weight: bold;
  color: #00ff88;
}

#ch-name {
  font-size: 26px;
}

/* ===== LOADING ===== */
#loading {
  position: fixed;
  inset: 0;
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
}
</style>
</head>
<style>
#channels {
  display: none;
  position: absolute;
  left: 0;
  top: 0;
  width: 40%;
  height: 100vh;
  background: #000;
  overflow-y: auto;
  font-family: Arial, sans-serif;
}

.channel {
  display: flex;
  gap: 14px;
  padding: 14px;
  font-size: 22px;
  border-bottom: 1px solid #222;
  color: white;
}

.channel span.number {
  width: 60px;
  color: #00aaff;
  font-weight: bold;
}

.channel.active {
  background: #0055aa;
}
</style>
</head>
<body>

<div id="loading">Scanning channelsâ€¦</div>

<video id="video" controls autoplay></video>

<div id="info">
  <div id="ch-num">001</div>
  <div id="ch-name">Channel</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
const M3U_URL = "./playlist.m3u";

let channels = [];
let current = 0;
let hls;
let infoTimer;

/* ===== LOAD PLAYLIST ===== */
fetch(M3U_URL)
  .then(r => r.text())
  .then(parseM3U);

function parseM3U(data) {
  const lines = data.split("\n");
  let ch = {};

  for (let line of lines) {
    line = line.trim();

    if (line.startsWith("#EXTINF")) {
      ch = { name: line.split(",").pop() };
    } else if (line.startsWith("http")) {
      ch.url = line;
      channels.push(ch);
    }
  }

  document.getElementById("loading").style.display = "none";
  play(0);
}

/* ===== PLAY ===== */
function play(index) {
  if (!channels[index]) return;

  current = index;
  showInfo();

  const video = document.getElementById("video");
  const url = channels[index].url;

  if (Hls.isSupported()) {
    if (hls) hls.destroy();
    hls = new Hls();
    hls.loadSource(url);
    hls.attachMedia(video);
  } else {
    video.src = url;
  }
}

/* ===== INFO BAR ===== */
function showInfo() {
  const info = document.getElementById("info");
  document.getElementById("ch-num").textContent =
    String(current + 1).padStart(3, "0");
  document.getElementById("ch-name").textContent =
    channels[current].name;

  info.classList.add("show");

  clearTimeout(infoTimer);
  infoTimer = setTimeout(() => info.classList.remove("show"), 3000);
}

/* ===== REMOTE CONTROLS ===== */
document.addEventListener("keydown", e => {
  if (e.key === "ArrowUp") {
    play((current + 1) % channels.length);
  }

  if (e.key === "ArrowDown") {
    play((current - 1 + channels.length) % channels.length);
  }

  if (e.key === "Enter" || e.key === "Info") {
    showInfo();
  }
});
</script>

</body>
  <script>
document.addEventListener("DOMContentLoaded", () => {
  const channelList = document.getElementById("channels");

  if (!channelList) return;

  // Hide channel list by default (TV-style)
  channelList.style.display = "none";

  function toggleChannels() {
    channelList.style.display =
      channelList.style.display === "none" ? "block" : "none";
  }

  // Listen for TV remote OK / Enter
  document.addEventListener("keydown", (e) => {
    if (
      e.key === "Enter" ||
      e.key === "OK" ||
      e.keyCode === 13
    ) {
      e.preventDefault();
      toggleChannels();
    }
  });
});
</script>
</body>
  <script>
let currentIndex = 0;
let channels = [];

document.addEventListener("DOMContentLoaded", () => {
  const list = document.getElementById("channels");

  function render() {
    list.innerHTML = "";
    channels.forEach((ch, i) => {
      const div = document.createElement("div");
      div.className = "channel" + (i === currentIndex ? " active" : "");
      div.innerHTML = `
        <span class="number">${String(i + 1).padStart(3, "0")}</span>
        <span>${ch.name}</span>
      `;
      div.onclick = () => play(ch.url);
      list.appendChild(div);
    });
  }

  document.addEventListener("keydown", e => {
    if (e.key === "Enter" || e.keyCode === 13) {
      list.style.display = "block";
    }

    if (e.key === "ArrowDown") {
      currentIndex = Math.min(currentIndex + 1, channels.length - 1);
      render();
    }

    if (e.key === "ArrowUp") {
      currentIndex = Math.max(currentIndex - 1, 0);
      render();
    }

    if (e.key === "OK") {
      play(channels[currentIndex].url);
    }
  });

  fetch("playlist.m3u")
    .then(r => r.text())
    .then(data => {
      let temp = {};
      data.split("\n").forEach(line => {
        line = line.trim();
        if (line.startsWith("#EXTINF")) {
          temp = { name: line.split(",").pop() };
        } else if (line.startsWith("http")) {
          temp.url = line;
          channels.push(temp);
        }
      });
      render();
    });
});

function play(url) {
  const video = document.getElementById("video");
  video.src = url;
  video.play().catch(()=>{});
}
</script>
</body>
  <script>
let inputBuffer = "";
let inputTimer;
const inputTimeout = 1500; // 1.5s to complete number

document.addEventListener("keydown", e => {
  // Only number keys (0-9)
  if (e.key >= "0" && e.key <= "9") {
    inputBuffer += e.key;

    clearTimeout(inputTimer);
    inputTimer = setTimeout(() => {
      const index = parseInt(inputBuffer, 10) - 1; // 1-based numbering
      if (channels[index]) {
        currentIndex = index;
        play(channels[currentIndex].url);
        render(); // update highlight
      }
      inputBuffer = "";
    }, inputTimeout);
  }
});
</script>
</body>
</html>
